# Forensics/ malware
## Max Attampts: 3
## Tags: malware,forensics
## Challenge Name: Very EZ-Virus 1
- **Challenge Level**: Easy-Medium  
- **Challenge Points**: 100  
- **Challenge Author**: (0xf4h1m)

### Challenge Description:
I found a Rulebook, but when I opened it, some malicious activity occurred. I suspect it may contain malware. Your task is to find the IOC (Indicator of Compromise) URL where it tries to connect.

**Author**: [Oxf4h1m](https://fb.com/fa11m)
**Download**: [RuleBook.docm]  
**Flag Format**: `BUETCTF{url}`

**Challenge Flag**: `BUETCTF{http://oshi.at/FCED/secret.ps1}`

### Solution 
in vba macro you will find a finction  
```
Function fyuuscgwug() As String
    Dim uylfuwgfugfuwg As String
    Dim utdyqfiyfyuuaku As Integer
    Dim hvjsdgjgscj As Variant
    Dim yfdwuGFGYWGU As Variant
    Dim i As Integer

    hvjsdgjgscj = Array(39, 34, 56, 54, 49, 56, 73, 28, 66, 62, 42, 79, 27, 51, 56, 60, 62, 57, 46, 24, 37, 62, 94, 57, 44, 46, 18, 32, 33, 19, 70, 38, 64, 87, 49, 100, 41, 58, 62, 36, 81, 55, 15, 56, 36, 34, 2, 28, 87, 41, 51, 27, 21, 62, 18, 54, 70, 95, 64, 86, 31, 39, 51, 18, 65, 87, 33, 89, 41, 31, 59, 35, 62, 48, 50, 110, 53, 41, 74, 21, 51, 76, 50, 108, 29, 65, 75, 51, 50, 105, 43, 35, 58, 42, 50, 55, 56, 62, 29, 92, 57, 25, 32, 55, 50, 43, 65, 94, 35, 22, 54, 20, 78, 55, 44, 71, 26, 43, 41, 41, 42, 79, 15, 69, 37, 63, 87, 35, 63, 53, 61, 92, 46, 33, 74, 18, 97, 63, 44, 106, 33, 19, 101, 62, 71, 88, 59, 69, 34, 40, 18, 39, 49, 92, 42, 105, 61, 37, 68, 31, 56, 90, 50, 92, 16, 23, 32, 48, 44, 104, 28, 63, 60, 51, 30, 52, 70, 58, 56, 31, 47, 54, 26, 43, 55, 75, 55, 97, 27, 47, 55, 20, 59, 65, 46, 92, 49, 37, 41, 27, 66, 93, 45, 85, 50, 49, 73, 23, 31, 65, 39, 96, 51, 35, 72, 42, 63, 66, 31, 85, 49, 51, 35, 30)
    yfdwuGFGYWGU = Array(44, 47, 10, 16, 16, 16, 30, 37, 7, 3, 23, 32, 38, 16, 47, 5, 36, 46, 20, 46, 28, 8, 5, 8, 32, 35, 48, 48, 32, 50, 3, 27, 19, 16, 17, 8, 24, 11, 15, 29, 19, 10, 50, 47, 29, 37, 50, 37, 3, 40, 15, 21, 44, 5, 34, 11, 30, 24, 2, 22, 34, 32, 22, 47, 24, 32, 33, 26, 24, 40, 48, 30, 28, 33, 16, 7, 12, 31, 7, 44, 24, 5, 15, 9, 36, 6, 6, 14, 48, 14, 23, 16, 7, 29, 2, 10, 42, 3, 37, 26, 8, 46, 37, 10, 40, 22, 1, 28, 30, 50, 27, 45, 21, 48, 22, 41, 39, 28, 11, 24, 48, 40, 50, 42, 28, 4, 16, 30, 10, 50, 5, 19, 19, 39, 7, 47, 3, 2, 22, 13, 32, 49, 10, 3, 5, 31, 6, 49, 31, 31, 38, 26, 50, 27, 24, 6, 4, 34, 39, 34, 20, 13, 16, 12, 49, 49, 49, 17, 32, 15, 38, 8, 5, 18, 47, 13, 12, 23, 10, 38, 18, 13, 30, 22, 44, 44, 11, 11, 38, 24, 22, 45, 40, 38, 20, 16, 16, 35, 40, 38, 10, 10, 21, 34, 15, 23, 4, 42, 46, 16, 26, 9, 14, 32, 35, 23, 12, 15, 34, 27, 16, 14, 26, 31)

    uylfuwgfugfuwg = ""

    For i = LBound(hvjsdgjgscj) To UBound(hvjsdgjgscj)
        ' Decode the character
        utdyqfiyfyuuaku = hvjsdgjgscj(i) + yfdwuGFGYWGU(i)
        uylfuwgfugfuwg = uylfuwgfugfuwg & ChrW(utdyqfiyfyuuaku)
    Next i
    
    fyuuscgwug = uylfuwgfugfuwg
End Function
````
Execute this function you will get the flag

---

## Challenge Name: Very EZ-Virus 2
- **Challenge Level**: Easy-Medium  
- **Challenge Points**: 100  
- **Challenge Author**: (0xf4h1m)  
- **Prerequisite**: Very EZ-Virus 1

### Challenge Description:
Find the flag based on the malicious activity discovered in the previous challenge.

**Challenge Flag**: `BUETCTF{M4lw4r3_F0r3ns1cs_R3v34ls_Crypt1c_B3h4v10rs_4nd_H1dd3n_P3rs1st3nc3_M3ch4n1sms}`
### solution: 

open 'http://oshi.at/FCED/secret.ps1' 
you will get `cSZ0JXIldUx8Yz1IY0NiMHVfQ2I/RGA0RDAjYkdiYz1EMHJDSkFFYDQwcWI5Y0dgX0NEMGM/NTB3YDU1Yj8wIWJDRGBERWI/NGIwfGI0OWM/YEQ+RE4=` 
decrypt base64> Rot47 > Plaintext

---

## Challenge Name: Lethal Payload 1
- **Challenge Level**: Easy-Medium  
- **Challenge Points**: 100  
- **Challenge Author**: (0xf4h1m)  
- **Prerequisite**: Very EZ-Virus 2

### Challenge Description:
I want to share a secret with you. To create the malicious document from the previous challenge, I used a tool called `doc-macro-exploit`. However, this tool contains another malware. Your task is to analyze and find the URL from where the malware script is downloaded.
**Flag Format**: `BUETCTF{url}`

**Challenge Flag**: `BUETCTF{https://bananasquad.ru/paste}`
### Solution: 
search tools with name. you will get github repo . in the file `[https://raw.githubusercontent.com/drat/virus-macro-generator/refs/heads/main/makemymacro.py](https://github.com/drat/virus-macro-generator/blob/main/makemymacro.py)` you will get an ecrypted text in line 4. decrypt and get the flag. 

---
## Challenge Name: Lethal Payload 2
- **Challenge Level**: Easy-Medium  
- **Challenge Points**: 150  
- **Challenge Author**: (0xf4h1m)  
- **Prerequisite**: Lethal Payload 1

### Challenge Description:
Analyze and find what is the Decryption Key Of **main** Virus ? 

**Flag Format**: `BUETCTF{base64=}`

**Challenge Flag**: `BUETCTF{uSS2i-KrquUVErKGb1AFc7qQa695Aa_rae36i7Y9wUo=}`

#### Solution 
The Link https://bananasquad.ru/paste is dead but read content from wayback machine. 

---
## Challenge Name: Virus!!
- **Challenge Level**: Easy-Medium  
- **Challenge Points**: 150  
- **Challenge Author**: (0xf4h1m)  
- **Prerequisite**: Lethal Payload 2

### Challenge Description:
Now analyze the the main virus and Determine the type of virus  


**Flag Format**: `BUETCTF{TypeName}`


**Challenge Flag**: 
`BUETCTF{KeyLogger}`
`BUETCTF{PasswordStealer}`
`BUETCTF{PwStealer}`

### Solution: 

Decrypt and analyze with virus total. 
